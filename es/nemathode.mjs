var e,t,r={mathConstants:{E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG10E:Math.LOG10E,LOG2E:Math.LOG2E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2},functions:{abs:{implementation:Math.abs},min:{implementation:Math.min},areEqual:{implementation:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];return t.every((function(e){return e===t[0]}))}}},toInputType:function(e){return e},toOutputValue:function(e){return e},binaryOperators:{"+":{precedence:1,implementation:function(e,t){return e+t}},"-":{precedence:1,implementation:function(e,t){return e-t}},"*":{precedence:2,implementation:function(e,t){return e*t}},"/":{precedence:2,implementation:function(e,t){return e/t}},"%":{precedence:2,implementation:function(e,t){return e%t}}}};function n(e,t){return new SyntaxError("It's just unexpected operator "+e+" at position "+t+". '\n\t\t+ 'Remove it from there")}function o(e,t){return new SyntaxError("You are using unknown operand <"+e+"> at position '\n\t\t+ '"+t+".'\n\t\t+ '\n1. most likely you missed the operator between expressions'\n\t\t+ '\n2. or you forgot to define your implementation for this operator")}function a(e,t){return new SyntaxError("You are using unknown operand <"+e+"> at position "+t+".'\n\t\t+ '\n1. most likely you missed to write a number or expression'\n\t\t+ '\n2. or you forgot to cast string to number")}!function(e){e.Number="NUMBER",e.Function="FUNCTION",e.Expression="EXPRESSION",e.MathConstantName="MATH_CONSTANT",e.BinaryOperator="BINARY_OPERATOR"}(e||(e={})),function(e){e[e.LeftOperandProcessing=1]="LeftOperandProcessing",e[e.OperatorProcessing=2]="OperatorProcessing",e[e.ReadyToCalcXValue=3]="ReadyToCalcXValue",e[e.AllOperandsAreProcessed=4]="AllOperandsAreProcessed"}(t||(t={}));var i={operandsProcessedAlready:0,evaluationStage:t.LeftOperandProcessing,memoizedLValue:void 0,memoizedRValue:void 0,memoizedBinaryOperator:void 0};function s(e){e.operandsProcessedAlready+=1}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(e,t){return p(function(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},i),e,t)},p=function r(i,u,c){for(;!1==i.operandsProcessedAlready>=u.length;){var p=u[i.operandsProcessedAlready];switch(i.evaluationStage){case t.LeftOperandProcessing:switch(p.type){case e.MathConstantName:case e.Number:i.evaluationStage=t.OperatorProcessing,i.memoizedLValue=c.toInputType(p.value),s(i);break;case e.Function:var d=p.value,m=c.functions[d.name].implementation.apply(void 0,d.args);i.evaluationStage=t.OperatorProcessing,i.memoizedLValue=c.toInputType(m),s(i);break;case e.Expression:i.evaluationStage=t.OperatorProcessing,i.memoizedLValue=c.toInputType(l(p.value,c)),s(i);break;case e.BinaryOperator:throw n(p.value,i.operandsProcessedAlready)}break;case t.OperatorProcessing:switch(p.type){case e.BinaryOperator:i.evaluationStage=t.ReadyToCalcXValue,i.memoizedBinaryOperator=p.value,s(i);break;case e.Expression:case e.MathConstantName:case e.Number:throw o(p.value,i.operandsProcessedAlready)}break;case t.ReadyToCalcXValue:switch(p.type){case e.MathConstantName:case e.Number:i.evaluationStage=t.AllOperandsAreProcessed,i.memoizedRValue=c.toInputType(p.value),s(i);break;case e.Function:var y=p.value,f=c.functions[y.name].implementation.apply(void 0,y.args);i.evaluationStage=t.AllOperandsAreProcessed,i.memoizedRValue=c.toInputType(f),s(i);break;case e.Expression:i.evaluationStage=t.AllOperandsAreProcessed,i.memoizedRValue=c.toInputType(l(p.value,c)),s(i);break;case e.BinaryOperator:throw a(p.value,i.operandsProcessedAlready)}break;case t.AllOperandsAreProcessed:switch(p.type){case e.BinaryOperator:var h=p.value,O=i.memoizedBinaryOperator;if(c.binaryOperators[O].precedence<c.binaryOperators[h].precedence){var g={evaluationStage:t.ReadyToCalcXValue,operandsProcessedAlready:i.operandsProcessedAlready+1,memoizedLValue:i.memoizedRValue,memoizedBinaryOperator:h,memoizedRValue:void 0};i.evaluationStage=t.AllOperandsAreProcessed,i.memoizedRValue=c.toInputType(r(g,u,c)),i.operandsProcessedAlready=g.operandsProcessedAlready}else i.evaluationStage=t.ReadyToCalcXValue,i.memoizedLValue=c.binaryOperators[O].implementation(i.memoizedLValue,i.memoizedRValue),i.memoizedBinaryOperator=h,i.memoizedRValue=void 0,s(i)}}}return c.toOutputValue(i.memoizedBinaryOperator?c.binaryOperators[i.memoizedBinaryOperator].implementation(i.memoizedLValue,i.memoizedRValue):i.memoizedLValue)};function d(e,t){if(0===e.length)return t.length;if(0===t.length)return e.length;var r,n,o=[];for(r=0;t.length>=r;r++)o[r]=[r];for(n=0;e.length>=n;n++)o[0][n]=n;for(r=1;t.length>=r;r++)for(n=1;e.length>=n;n++)o[r][n]=t.charAt(r-1)===e.charAt(n-1)?o[r-1][n-1]:Math.min(o[r-1][n-1]+1,Math.min(o[r][n-1]+1,o[r-1][n]+1));return o[t.length][e.length]}function m(e,t){return e.distance-t.distance}function y(e,t){for(var r=t.map((function(t){return function(e,t){for(var r=[],n=0;t.length>n;++n){var o=t[n],a=d(e,o);r.push({source:e,suggestion:o,distance:a})}return function(e){return e.filter((function(e){return e.source.length>e.distance||e.suggestion.includes(e.source)}))}(r)}(e,t)})).filter((function(e){return e.length>0})),n=[],o=0;r.length>o;++o)for(var a=0;r[o].length>a;++a)n.push(r[o][a]);return n.sort(m)}function f(e,t){return new SyntaxError(function(e,t){var r=y(e,t),n="Cannot find operand --\x3e "+e+".\n",o="Most likely you made a mistake when you were writing the operand or you forgot to cast string to number.\n";if(0===r.length)return n+o+"There are nothing even remotely close to your input in config you passed :(";return n+o+"Maybe you want to use on of the following?\n"+r.reduce((function(e,t){return e+"\t"+t.suggestion+"\n"}),"")}(e,[Object.keys(t.functions),Object.keys(t.mathConstants),Object.keys(t.binaryOperators)]))}function h(t,r){if(!Array.isArray(t))throw new SyntaxError("It looks like you passed expression with wrong format:\n1. Check your expression, please\n2. Check TS configuration");if(0===t.length)throw new SyntaxError("It looks like you passed an empty expression\n1. Please check your expression");for(var n=[],o=0;t.length>o;++o)if("number"!=typeof t[o]){var a="string"==typeof t[o];if(a&&r.binaryOperators[t[o]])n.push({type:e.BinaryOperator,value:t[o]});else if(a&&r.mathConstants[t[o]])n.push({type:e.MathConstantName,value:r.mathConstants[t[o]]});else if(Array.isArray(t[o])&&"string"==typeof t[o][0]&&r.functions[t[o][0]]){var i=[].concat(t[o]),s=i.shift(),u=[].concat(i);n.push({type:e.Function,value:{name:s,args:u}})}else{var c=n.length;if(!(c>0&&n[c-1].type===e.Function)){if(!Array.isArray(t[o]))throw f(t[o],r);var l={type:e.Expression,value:h(t[o],r)};n.push(l)}}}else{n.push({type:e.Number,value:t[o]})}return n}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=function(e){var t=this;this.evaluate=function(e){var r=h(e,g({},t.config));return l([].concat(r),g({},t.config))},this.evaluatePlease=function(e){return console.info("ðŸ¤—"),t.evaluate(e)},this.evaluateAst=function(e){return l([].concat(e),g({},t.config))},this.getAst=function(e){return h(e,g({},t.config))},this.config=e,this.mathConstants=e.mathConstants};function P(e){return new b({mathConstants:(null==e?void 0:e.mathConstants)||r.mathConstants,functions:(null==e?void 0:e.functions)||r.functions,binaryOperators:(null==e?void 0:e.binaryOperators)||r.binaryOperators,toInputType:(null==e?void 0:e.toInputType)||r.toInputType,toOutputValue:(null==e?void 0:e.toOutputValue)||r.toOutputValue})}export default P;
